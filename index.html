<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŠ å¯†è´§å¸äº¤æ˜“åŠ©æ‰‹</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: linear-gradient(135deg, #0d0d1a 0%, #1a1a2e 100%); min-height: 100vh; padding: 20px; }
        .container { max-width: 1400px; margin: 0 auto; }
        h1 { text-align: center; color: #fff; margin-bottom: 30px; font-size: 2rem; }
        .tabs { display: flex; gap: 10px; margin-bottom: 30px; flex-wrap: wrap; justify-content: center; }
        .tab-btn { padding: 12px 25px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); border-radius: 25px; color: rgba(255,255,255,0.8); cursor: pointer; transition: all 0.3s; }
        .tab-btn:hover, .tab-btn.active { background: linear-gradient(135deg, #667eea, #764ba2); border-color: transparent; color: #fff; }
        .tab-content { display: none; animation: fadeIn 0.5s; }
        .tab-content.active { display: block; }
        .prices-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .card { background: rgba(255,255,255,0.08); backdrop-filter: blur(10px); border-radius: 20px; padding: 25px; border: 1px solid rgba(255,255,255,0.15); transition: all 0.3s; }
        .card:hover { transform: translateY(-5px); box-shadow: 0 10px 40px rgba(0,0,0,0.3); }
        .card-btc { border-left: 4px solid #f7931a; }
        .card-eth { border-left: 4px solid #627eea; }
        .coin-name { display: flex; align-items: center; gap: 10px; margin-bottom: 15px; }
        .coin-name img { width: 35px; height: 35px; }
        .coin-name h2 { color: #fff; font-size: 1.3rem; }
        .price { font-size: 2.2rem; font-weight: bold; color: #fff; margin-bottom: 5px; }
        .change { display: flex; align-items: center; gap: 5px; font-size: 1rem; margin: 10px 0; }
        .change.up { color: #00c853; }
        .change.down { color: #ff1744; }
        .source-tag { display: inline-block; padding: 3px 10px; border-radius: 10px; font-size: 0.7rem; margin-left: 10px; background: rgba(255,255,255,0.1); color: rgba(255,255,255,0.6); }
        .source-tag.binance { background: rgba(243,186,47,0.3); color: #f3ba2f; }
        .summary-cards { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .summary-card { background: rgba(255,255,255,0.08); border-radius: 15px; padding: 20px; text-align: center; }
        .summary-card h3 { color: rgba(255,255,255,0.6); font-size: 0.9rem; margin-bottom: 10px; }
        .summary-card .value { font-size: 1.8rem; font-weight: bold; color: #fff; }
        .summary-card .value.profit { color: #00c853; }
        .summary-card .value.loss { color: #ff1744; }
        .positions-section { background: rgba(255,255,255,0.05); border-radius: 20px; padding: 25px; margin-bottom: 30px; }
        .section-title { color: #fff; font-size: 1.5rem; margin-bottom: 20px; }
        .add-position { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-bottom: 20px; }
        .add-position input, .add-position select { padding: 12px 15px; border: 1px solid rgba(255,255,255,0.2); border-radius: 12px; background: rgba(255,255,255,0.1); color: #fff; font-size: 1rem; }
        .add-position input:focus, .add-position select:focus { outline: none; border-color: #667eea; }
        .add-btn { padding: 12px 25px; background: linear-gradient(135deg, #00c853, #00a152); border: none; border-radius: 12px; color: white; font-size: 1rem; cursor: pointer; }
        .add-btn:hover { transform: scale(1.05); }
        .positions-list { display: grid; gap: 15px; }
        .position-item { background: rgba(255,255,255,0.08); border-radius: 15px; padding: 20px; display: grid; grid-template-columns: 1fr auto; gap: 15px; align-items: center; animation: fadeIn 0.3s; }
        .position-info h3 { color: #fff; font-size: 1.2rem; margin-bottom: 8px; }
        .position-info p { color: rgba(255,255,255,0.6); font-size: 0.9rem; }
        .position-pnl { text-align: right; }
        .pnl-value { font-size: 1.5rem; font-weight: bold; }
        .pnl-value.profit { color: #00c853; }
        .pnl-value.loss { color: #ff1744; }
        .trade-type { padding: 5px 12px; border-radius: 15px; font-size: 0.85rem; }
        .trade-type.long { background: rgba(0,200,83,0.3); color: #00c853; }
        .trade-type.short { background: rgba(255,23,68,0.3); color: #ff1744; }
        .calculator-section { background: rgba(255,255,255,0.05); border-radius: 20px; padding: 25px; margin-bottom: 30px; }
        .calc-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 30px; }
        .calc-box { background: rgba(255,255,255,0.05); border-radius: 15px; padding: 20px; }
        .calc-box h4 { color: #fff; font-size: 1.1rem; margin-bottom: 15px; }
        .calc-inputs { display: grid; gap: 15px; }
        .calc-inputs input { padding: 12px 15px; border: 1px solid rgba(255,255,255,0.2); border-radius: 10px; background: rgba(255,255,255,0.1); color: #fff; }
        .calc-inputs input:focus { outline: none; border-color: #667eea; }
        .calc-result { margin-top: 15px; padding: 15px; background: rgba(102,126,234,0.2); border-radius: 10px; }
        .calc-result .label { color: rgba(255,255,255,0.6); font-size: 0.9rem; }
        .calc-result .value { font-size: 1.5rem; font-weight: bold; color: #fff; margin-top: 5px; }
        .risk-section { background: rgba(255,255,255,0.05); border-radius: 20px; padding: 25px; margin-bottom: 30px; }
        .risk-meter { height: 20px; background: rgba(255,255,255,0.1); border-radius: 10px; overflow: hidden; margin: 20px 0; }
        .risk-fill { height: 100%; border-radius: 10px; transition: width 0.5s; }
        .risk-fill.low { background: linear-gradient(90deg, #00c853, #69f0ae); }
        .risk-fill.medium { background: linear-gradient(90deg, #ffab00, #ffd740); }
        .risk-fill.high { background: linear-gradient(90deg, #ff1744, #ff5252); }
        .twitter-section { background: rgba(255,255,255,0.05); border-radius: 20px; padding: 25px; }
        .search-box { display: flex; gap: 10px; margin-bottom: 20px; }
        .search-box input { flex: 1; padding: 12px 20px; border: 1px solid rgba(255,255,255,0.2); border-radius: 25px; background: rgba(255,255,255,0.1); color: #fff; }
        .search-box button { padding: 12px 25px; background: linear-gradient(135deg, #1da1f2, #0d8ecf); border: none; border-radius: 25px; color: white; cursor: pointer; }
        .preset-btns { display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 20px; }
        .preset-btn { padding: 8px 16px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); border-radius: 20px; color: rgba(255,255,255,0.8); cursor: pointer; }
        .preset-btn:hover, .preset-btn.active { background: rgba(29,161,242,0.3); border-color: #1da1f2; }
        .tweet { background: rgba(255,255,255,0.08); border-radius: 12px; padding: 18px; border-left: 4px solid #1da1f2; margin-bottom: 15px; }
        .tweet-header { display: flex; align-items: center; gap: 10px; margin-bottom: 10px; }
        .tweet-content { color: #fff; line-height: 1.5; }
        .tweet-content a { color: #1da1f2; }
        .history-section { background: rgba(255,255,255,0.05); border-radius: 20px; padding: 25px; }
        .history-item { display: grid; grid-template-columns: auto 1fr auto auto; gap: 15px; padding: 15px; background: rgba(255,255,255,0.05); border-radius: 10px; margin-bottom: 10px; align-items: center; }
        .trade-coin { color: #fff; font-weight: bold; }
        .trade-info { color: rgba(255,255,255,0.6); font-size: 0.9rem; }
        .trade-pnl { font-weight: bold; }
        .trade-pnl.profit { color: #00c853; }
        .trade-pnl.loss { color: #ff1744; }
        .loading { text-align: center; color: rgba(255,255,255,0.6); padding: 30px; }
        .footer { text-align: center; color: rgba(255,255,255,0.4); margin-top: 30px; font-size: 0.85rem; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ’° åŠ å¯†è´§å¸äº¤æ˜“åŠ©æ‰‹</h1>
        <div class="tabs">
            <button class="tab-btn active" onclick="showTab('dashboard')">ğŸ“Š ä»ªè¡¨ç›˜</button>
            <button class="tab-btn" onclick="showTab('positions')">ğŸ’¼ æŒä»“</button>
            <button class="tab-btn" onclick="showTab('calculator')">ğŸ§® è®¡ç®—å™¨</button>
            <button class="tab-btn" onclick="showTab('risk')">âš ï¸ é£é™©</button>
            <button class="tab-btn" onclick="showTab('twitter')">ğŸ¦ Twitter</button>
            <button class="tab-btn" onclick="showTab('history')">ğŸ“œ å†å²</button>
        </div>
        
        <div id="dashboard" class="tab-content active">
            <div class="prices-grid">
                <div class="card card-btc">
                    <div class="coin-name">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/4/46/Bitcoin.svg/1200px-Bitcoin.svg.png" alt="BTC">
                        <h2>Bitcoin (BTC) <span class="source-tag" id="btc-source">LOADING</span></h2>
                    </div>
                    <div class="price" id="btc-price">---</div>
                    <div class="change" id="btc-change">åŠ è½½ä¸­...</div>
                </div>
                <div class="card card-eth">
                    <div class="coin-name">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/0/05/Ethereum_logo_2014.svg/1200px-Ethereum_logo_2014.svg.png" alt="ETH">
                        <h2>Ethereum (ETH) <span class="source-tag" id="eth-source">LOADING</span></h2>
                    </div>
                    <div class="price" id="eth-price">---</div>
                    <div class="change" id="eth-change">åŠ è½½ä¸­...</div>
                </div>
            </div>
            <div class="summary-cards">
                <div class="summary-card">
                    <h3>æ€»æŒä»“ä»·å€¼</h3>
                    <div class="value" id="total-value">$0.00</div>
                </div>
                <div class="summary-card">
                    <h3>æ€»ç›ˆäº</h3>
                    <div class="value" id="total-pnl">$0.00</div>
                </div>
                <div class="summary-card">
                    <h3>æ”¶ç›Šç‡</h3>
                    <div class="value" id="total-percent">0.00%</div>
                </div>
                <div class="summary-card">
                    <h3>äº¤æ˜“æ¬¡æ•°</h3>
                    <div class="value" id="trade-count">0</div>
                </div>
            </div>
        </div>
        
        <div id="positions" class="tab-content">
            <div class="positions-section">
                <h2 class="section-title">ğŸ’¼ æ·»åŠ æ–°æŒä»“</h2>
                <div class="add-position">
                    <input type="text" id="pos-coin" placeholder="å¸ç§ (å¦‚: BTC)">
                    <input type="number" id="pos-amount" placeholder="æ•°é‡" step="any">
                    <input type="number" id="pos-entry" placeholder="ä¹°å…¥å‡ä»·" step="any">
                    <select id="pos-side">
                        <option value="long">åšå¤š ğŸŸ¢</option>
                        <option value="short">åšç©º ğŸ”´</option>
                    </select>
                    <button class="add-btn" onclick="addPosition()">â• æ·»åŠ </button>
                </div>
                <h3 class="section-title">ğŸ“‹ å½“å‰æŒä»“</h3>
                <div class="positions-list" id="positions-list"><div class="loading">æš‚æ— æŒä»“</div></div>
            </div>
        </div>
        
        <div id="calculator" class="tab-content">
            <div class="calculator-section">
                <div class="calc-grid">
                    <div class="calc-box">
                        <h4>ğŸ¯ æ­¢ç›ˆæ­¢æŸè®¡ç®—å™¨</h4>
                        <div class="calc-inputs">
                            <input type="number" id="calc-entry" placeholder="ä¹°å…¥ä»·æ ¼" step="any">
                            <input type="number" id="calc-size" placeholder="ä»“ä½å¤§å° (USDT)" step="any">
                            <input type="number" id="calc-tp" placeholder="æ­¢ç›ˆæ¯”ä¾‹ %" value="10">
                            <input type="number" id="calc-sl" placeholder="æ­¢æŸæ¯”ä¾‹ %" value="5">
                            <button class="add-btn" onclick="calcTpSl()">è®¡ç®—</button>
                        </div>
                        <div class="calc-result" id="calc-result-tp-sl"><div class="label">è¾“å…¥å‚æ•°åç‚¹å‡»è®¡ç®—</div></div>
                    </div>
                    <div class="calc-box">
                        <h4>ğŸ“ ä»“ä½è®¡ç®—å™¨</h4>
                        <div class="calc-inputs">
                            <input type="number" id="calc-balance" placeholder="è´¦æˆ·ä½™é¢ (USDT)" step="any">
                            <input type="number" id="calc-risk" placeholder="é£é™©æ¯”ä¾‹ %" value="2">
                            <input type="number" id="calc-stop" placeholder="æ­¢æŸè·ç¦» %" step="any">
                            <button class="add-btn" onclick="calcSize()">è®¡ç®—</button>
                        </div>
                        <div class="calc-result" id="calc-result-size"><div class="label">è¾“å…¥å‚æ•°åç‚¹å‡»è®¡ç®—</div></div>
                    </div>
                    <div class="calc-box">
                        <h4>ğŸ’° ç›ˆäºè®¡ç®—å™¨</h4>
                        <div class="calc-inputs">
                            <input type="number" id="pnl-entry" placeholder="ä¹°å…¥ä»·æ ¼" step="any">
                            <input type="number" id="pnl-current" placeholder="å½“å‰ä»·æ ¼" step="any">
                            <input type="number" id="pnl-amount" placeholder="æŒä»“æ•°é‡" step="any">
                            <button class="add-btn" onclick="calcPnL()">è®¡ç®—</button>
                        </div>
                        <div class="calc-result" id="calc-result-pnl"><div class="label">è¾“å…¥å‚æ•°åç‚¹å‡»è®¡ç®—</div></div>
                    </div>
                    <div class="calc-box">
                        <h4>ğŸ“ˆ å¤åˆ©è®¡ç®—å™¨</h4>
                        <div class="calc-inputs">
                            <input type="number" id="compound-principal" placeholder="åˆå§‹èµ„é‡‘" step="any">
                            <input type="number" id="compound-rate" placeholder="æ—¥æ”¶ç›Šç‡ %" value="1">
                            <input type="number" id="compound-days" placeholder="å¤©æ•°" value="30">
                            <button class="add-btn" onclick="calcCompound()">è®¡ç®—</button>
                        </div>
                        <div class="calc-result" id="calc-result-compound"><div class="label">è¾“å…¥å‚æ•°åç‚¹å‡»è®¡ç®—</div></div>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="risk" class="tab-content">
            <div class="risk-section">
                <h2 class="section-title">âš ï¸ é£é™©è¯„ä¼°</h2>
                <div class="summary-cards">
                    <div class="summary-card">
                        <h3>é£é™©ç­‰çº§</h3>
                        <div class="value" id="risk-level">---</div>
                    </div>
                    <div class="summary-card">
                        <h3>å»ºè®®ä»“ä½</h3>
                        <div class="value" id="suggested-size">---</div>
                    </div>
                    <div class="summary-card">
                        <h3>æœ€å¤§å¯æŸ</h3>
                        <div class="value" id="max-loss">---</div>
                    </div>
                </div>
                <div class="risk-meter"><div class="risk-fill low" id="risk-fill" style="width: 50%;"></div></div>
                <p style="color: rgba(255,255,255,0.6); text-align: center;" id="risk-advice">æ·»åŠ æŒä»“åæ˜¾ç¤ºé£é™©è¯„ä¼°</p>
            </div>
            <div class="calculator-section">
                <h3 class="section-title">ğŸ“‹ é£é™©ç®¡ç†è§„åˆ™</h3>
                <div style="color: rgba(255,255,255,0.8); line-height: 1.8;">
                    <p>âœ… <strong>å•ç¬”é£é™©</strong>ï¼šä¸è¶…è¿‡æ€»èµ„é‡‘çš„ 2%</p>
                    <p>âœ… <strong>æ—¥ç´¯è®¡é£é™©</strong>ï¼šä¸è¶…è¿‡æ€»èµ„é‡‘çš„ 6%</p>
                    <p>âœ… <strong>æ­¢ç›ˆæ­¢æŸæ¯”</strong>ï¼šè‡³å°‘ 2:1</p>
                    <p>âœ… <strong>åˆ†æ•£æŠ•èµ„</strong>ï¼šå•å¸ç§ä¸è¶…è¿‡ 25%</p>
                    <p>âœ… <strong>æ æ†æ§åˆ¶</strong>ï¼šæ–°æ‰‹å»ºè®®ä¸è¶…è¿‡ 5x</p>
                </div>
            </div>
        </div>
        
        <div id="twitter" class="tab-content">
            <div class="twitter-section">
                <h2 class="section-title">ğŸ¦ Twitter å…³æ³¨</h2>
                <div class="search-box">
                    <input type="text" id="twitter-user" placeholder="è¾“å…¥ç”¨æˆ·å (å¦‚: elonmusk)" onkeypress="if(event.key==='Enter')searchTwitter()">
                    <button onclick="searchTwitter()">ğŸ” æœç´¢</button>
                </div>
                <div class="preset-btns">
                    <button class="preset-btn" onclick="searchPreset('elonmusk')">Elon Musk</button>
                    <button class="preset-btn" onclick="searchPreset('realDonaldTrump')">Trump</button>
                    <button class="preset-btn" onclick="searchPreset('VitalikButerin')">Vitalik</button>
                    <button class="preset-btn" onclick="searchPreset('cz_binance')">CZ</button>
                    <button class="preset-btn" onclick="searchPreset('CryptoCarl')">CryptoCarl</button>
                </div>
                <div id="twitter-results"><div class="loading">ç‚¹å‡»ä¸Šæ–¹æŒ‰é’®æˆ–æœç´¢æŸ¥çœ‹æ¨æ–‡</div></div>
            </div>
        </div>
        
        <div id="history" class="tab-content">
            <div class="history-section">
                <h2 class="section-title">ğŸ“œ äº¤æ˜“å†å²</h2>
                <div id="history-list"><div class="loading">æš‚æ— äº¤æ˜“è®°å½•</div></div>
            </div>
        </div>
        
        <p class="footer">ğŸ’¡ é£é™©æç¤ºï¼šåŠ å¯†è´§å¸äº¤æ˜“æœ‰é£é™©ï¼ŒæŠ•èµ„éœ€è°¨æ…</p>
    </div>

    <script>
        const BINANCE_API = 'https://api.binance.com/api/v3';
        const COINGECKO_API = 'https://api.coingecko.com/api/v3';
        let positions = JSON.parse(localStorage.getItem('positions') || '[]');
        
        function showTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
            event.target.classList.add('active');
        }
        
        async function fetchPrice(source, symbol, coinId) {
            try {
                if (source === 'binance') {
                    const res = await fetch(`${BINANCE_API}/ticker/24hr?symbol=${symbol}`);
                    if (!res.ok) throw new Error('Failed');
                    const data = await res.json();
                    return { price: parseFloat(data.lastPrice), change: parseFloat(data.priceChangePercent), source: 'binance' };
                }
            } catch (e) {}
            try {
                const res = await fetch(`${COINGECKO_API}/simple/price?ids=${coinId}&vs_currencies=usd&include_24hr_change=true`);
                if (res.ok) {
                    const data = await res.json();
                    if (data[coinId]) return { price: data[coinId].usd, change: data[coinId].usd_24h_change, source: 'coingecko' };
                }
            } catch (e) {}
            return null;
        }
        
        async function fetchAllPrices() {
            let btc = await fetchPrice('binance', 'BTCUSDT', 'bitcoin');
            if (!btc) btc = await fetchPrice('coingecko', null, 'bitcoin');
            let eth = await fetchPrice('binance', 'ETHUSDT', 'ethereum');
            if (!eth) eth = await fetchPrice('coingecko', null, 'ethereum');
            
            if (btc) {
                document.getElementById('btc-price').textContent = `$${btc.price.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}`;
                document.getElementById('btc-change').innerHTML = `${btc.change >= 0 ? 'ğŸ“ˆ' : 'ğŸ“‰'} ${btc.change >= 0 ? '+' : ''}${btc.change.toFixed(2)}%`;
                document.getElementById('btc-change').className = `change ${btc.change >= 0 ? 'up' : 'down'}`;
                document.getElementById('btc-source').textContent = btc.source.toUpperCase();
            }
            if (eth) {
                document.getElementById('eth-price').textContent = `$${eth.price.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2})}`;
                document.getElementById('eth-change').innerHTML = `${eth.change >= 0 ? 'ğŸ“ˆ' : 'ğŸ“‰'} ${eth.change >= 0 ? '+' : ''}${eth.change.toFixed(2)}%`;
                document.getElementById('eth-change').className = `change ${eth.change >= 0 ? 'up' : 'down'}`;
                document.getElementById('eth-source').textContent = eth.source.toUpperCase();
            }
        }
        
        function addPosition() {
            const coin = document.getElementById('pos-coin').value.toUpperCase();
            const amount = parseFloat(document.getElementById('pos-amount').value);
            const entry = parseFloat(document.getElementById('pos-entry').value);
            const side = document.getElementById('pos-side').value;
            if (!coin || !amount || !entry) { alert('è¯·å¡«å†™å®Œæ•´ä¿¡æ¯'); return; }
            positions.push({ coin, amount, entry, side, time: Date.now() });
            localStorage.setItem('positions', JSON.stringify(positions));
            renderPositions();
            document.getElementById('pos-coin').value = '';
            document.getElementById('pos-amount').value = '';
            document.getElementById('pos-entry').value = '';
        }
        
        function deletePosition(index) {
            positions.splice(index, 1);
            localStorage.setItem('positions', JSON.stringify(positions));
            renderPositions();
        }
        
        async function renderPositions() {
            const container = document.getElementById('positions-list');
            if (positions.length === 0) { container.innerHTML = '<div class="loading">æš‚æ— æŒä»“</div>'; return; }
            let btcPrice = 0, ethPrice = 0;
            try { const btcRes = await fetch(`${BINANCE_API}/ticker/price?symbol=BTCUSDT`); btcPrice = parseFloat((await btcRes.json()).price); } catch (e) {}
            try { const ethRes = await fetch(`${BINANCE_API}/ticker/price?symbol=ETHUSDT`); ethPrice = parseFloat((await ethRes.json()).price); } catch (e) {}
            
            let html = '';
            positions.forEach((pos, i) => {
                const currentPrice = pos.coin === 'BTC' ? btcPrice : (pos.coin === 'ETH' ? ethPrice : pos.entry);
                const pnl = (currentPrice - pos.entry) * pos.amount * (pos.side === 'short' ? -1 : 1);
                const pnlPercent = ((currentPrice - pos.entry) / pos.entry * 100) * (pos.side === 'short' ? -1 : 1);
                const sideText = pos.side === 'long' ? 'åšå¤š' : 'åšç©º';
                html += `<div class="position-item"><div class="position-info"><h3>${pos.coin} <span class="trade-type ${pos.side}">${sideText}</span></h3><p>æ•°é‡: ${pos.amount} | å‡ä»·: $${pos.entry.toFixed(2)} | ç°ä»·: $${currentPrice.toFixed(2)}</p><button onclick="deletePosition(${i})" style="padding: 8px 15px; background: rgba(255,107,107,0.2); border: none; border-radius: 8px; color: #ff6b6b; cursor: pointer; margin-top: 10px;">åˆ é™¤</button></div><div class="position-pnl"><div class="pnl-value ${pnl >= 0 ? 'profit' : 'loss'}">${pnl >= 0 ? '+' : ''}$${pnl.toFixed(2)}</div><div class="pnl-value ${pnlPercent >= 0 ? 'profit' : 'loss'}" style="font-size: 1rem;">${pnlPercent >= 0 ? '+' : ''}${pnlPercent.toFixed(2)}%</div></div></div>`;
            });
            container.innerHTML = html;
        }
        
        function calcTpSl() {
            const entry = parseFloat(document.getElementById('calc-entry').value);
            const size = parseFloat(document.getElementById('calc-size').value);
            const tpPercent = parseFloat(document.getElementById('calc-tp').value);
            const slPercent = parseFloat(document.getElementById('calc-sl').value);
            if (!entry || !size || !tpPercent || !slPercent) { document.getElementById('calc-result-tp-sl').innerHTML = '<div class="label">è¯·å¡«å†™å®Œæ•´ä¿¡æ¯</div>'; return; }
            const tpPrice = entry * (1 + tpPercent / 100);
            const slPrice = entry * (1 - slPercent / 100);
            const ratio = tpPercent / slPercent;
            document.getElementById('calc-result-tp-sl').innerHTML = `<div class="label">æ­¢ç›ˆ: $${tpPrice.toFixed(2)} (+$${(size * tpPercent / 100).toFixed(2)})</div><div class="label">æ­¢æŸ: $${slPrice.toFixed(2)} (-$${(size * slPercent / 100).toFixed(2)})</div><div class="label" style="color: ${ratio >= 2 ? '#00c853' : '#ff6b6b'}">ç›ˆäºæ¯”: ${ratio.toFixed(2)}:1 ${ratio >= 2 ? 'âœ…' : 'âš ï¸'}</div>`;
        }
        
        function calcSize() {
            const balance = parseFloat(document.getElementById('calc-balance').value);
            const riskPercent = parseFloat(document.getElementById('calc-risk').value);
            const stopPercent = parseFloat(document.getElementById('calc-stop').value);
            if (!balance || !riskPercent || !stopPercent) { document.getElementById('calc-result-size').innerHTML = '<div class="label">è¯·å¡«å†™å®Œæ•´ä¿¡æ¯</div>'; return; }
            const riskAmount = balance * riskPercent / 100;
            const positionSize = riskAmount / (stopPercent / 100);
            document.getElementById('calc-result-size').innerHTML = `<div class="label">å¯æ‰¿å—äºæŸ: $${riskAmount.toFixed(2)}</div><div class="value">å»ºè®®ä»“ä½: $${positionSize.toFixed(2)}</div>`;
        }
        
        function calcPnL() {
            const entry = parseFloat(document.getElementById('pnl-entry').value);
            const current = parseFloat(document.getElementById('pnl-current').value);
            const amount = parseFloat(document.getElementById('pnl-amount').value);
            if (!entry || !current || !amount) { document.getElementById('calc-result-pnl').innerHTML = '<div class="label">è¯·å¡«å†™å®Œæ•´ä¿¡æ¯</div>'; return; }
            const pnl = (current - entry) * amount;
            const pnlPercent = (current - entry) / entry * 100;
            document.getElementById('calc-result-pnl').innerHTML = `<div class="value" style="color: ${pnl >= 0 ? '#00c853' : '#ff1744'}">${pnl >= 0 ? '+' : ''}$${pnl.toFixed(2)}</div><div class="label">${pnlPercent >= 0 ? '+' : ''}${pnlPercent.toFixed(2)}%</div>`;
        }
        
        function calcCompound() {
            const principal = parseFloat(document.getElementById('compound-principal').value);
            const dailyRate = parseFloat(document.getElementById('compound-rate').value);
            const days = parseFloat(document.getElementById('compound-days').value);
            if (!principal || !dailyRate || !days) { document.getElementById('calc-result-compound').innerHTML = '<div class="label">è¯·å¡«å†™å®Œæ•´ä¿¡æ¯</div>'; return; }
            const final = principal * Math.pow(1 + dailyRate / 100, days);
            const profit = final - principal;
            document.getElementById('calc-result-compound').innerHTML = `<div class="label">æœ€ç»ˆèµ„é‡‘: $${final.toFixed(2)}</div><div class="value" style="color: #00c853">ç›ˆåˆ©: +$${profit.toFixed(2)}</div><div class="label">æ”¶ç›Šç‡: +${((profit / principal) * 100).toFixed(2)}%</div>`;
        }
        
        function searchPreset(user) {
            document.getElementById('twitter-user').value = user;
            searchTwitter();
        }
        
        function searchTwitter() {
            const user = document.getElementById('twitter-user').value;
            if (!user) return;
            document.getElementById('twitter-results').innerHTML = '<div class="loading">åŠ è½½ä¸­...</div>';
            document.getElementById('twitter-results').innerHTML = `<div class="tweet"><div class="tweet-header"><h3>ğŸ“± ${user}</h3></div><div class="tweet-content"><p>ç‚¹å‡»æŸ¥çœ‹: <a href="https://nitter.net/${user}" target="_blank">https://nitter.net/${user}</a></p><p style="margin-top: 10px; color: rgba(255,255,255,0.6);">ä½¿ç”¨ Nitter è§‚çœ‹æ¨æ–‡ï¼ˆæ— éœ€ç™»å½•ï¼‰</p></div></div>`;
        }
        
        fetchAllPrices();
        renderPositions();
        setInterval(fetchAllPrices, 600000);
    </script>
</body>
</html>
