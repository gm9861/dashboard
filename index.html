<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŠ å¯†è´§å¸ä»ªè¡¨ç›˜</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; background: linear-gradient(135deg, #0d0d1a 0%, #1a1a2e 100%); min-height: 100vh; padding: 20px; color: #fff; }
        .container { max-width: 1200px; margin: 0 auto; }
        h1 { text-align: center; margin-bottom: 30px; font-size: 1.8rem; }
        
        .tabs { display: flex; gap: 10px; margin-bottom: 30px; flex-wrap: wrap; justify-content: center; }
        .tab-btn { padding: 10px 18px; background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); border-radius: 20px; color: rgba(255,255,255,0.8); cursor: pointer; transition: all 0.3s; font-size: 0.9rem; }
        .tab-btn:hover, .tab-btn.active { background: linear-gradient(135deg, #667eea, #764ba2); border-color: transparent; color: #fff; }
        
        .tab-content { display: none; animation: fadeIn 0.3s; }
        .tab-content.active { display: block; }
        
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; }
        .card { background: rgba(255,255,255,0.08); backdrop-filter: blur(10px); border-radius: 16px; padding: 20px; border: 1px solid rgba(255,255,255,0.15); }
        
        .section-title { font-size: 1.1rem; margin-bottom: 15px; display: flex; align-items: center; gap: 8px; }
        
        .metric { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .metric:last-child { border-bottom: none; }
        .metric-label { color: rgba(255,255,255,0.6); }
        .metric-value { font-weight: bold; }
        .metric-value.up { color: #00c853; }
        .metric-value.down { color: #ff1744; }
        
        .big-price { text-align: center; padding: 20px 0; }
        .big-price .value { font-size: 2.5rem; font-weight: bold; color: #667eea; }
        .big-price .label { color: rgba(255,255,255,0.5); margin-top: 5px; }
        
        .ahr999 { text-align: center; padding: 20px 0; }
        .ahr999 .value { font-size: 2rem; font-weight: bold; color: #667eea; }
        .ahr999 .zone { display: inline-block; padding: 8px 20px; border-radius: 20px; margin-top: 10px; font-weight: bold; }
        .ahr999 .desc { font-size: 0.75rem; color: rgba(255,255,255,0.4); margin-top: 15px; }
        
        .fear-gauge { text-align: center; padding: 20px 0; }
        .fear-value { font-size: 3rem; font-weight: bold; }
        .fear-label { font-size: 1.2rem; margin: 10px 0; }
        
        .keywords { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 15px; }
        .keyword { padding: 6px 14px; background: rgba(102,126,234,0.3); border-radius: 15px; font-size: 0.85rem; cursor: pointer; transition: transform 0.2s; }
        .keyword:hover { transform: scale(1.05); }
        
        .chart { display: flex; align-items: flex-end; gap: 8px; height: 150px; padding: 20px 0; justify-content: center; }
        .chart-bar { width: 30px; background: linear-gradient(to top, #667eea, #764ba2); border-radius: 4px 4px 0 0; transition: height 0.3s; }
        .chart-label { text-align: center; font-size: 0.7rem; color: rgba(255,255,255,0.5); margin-top: 5px; }
        
        .loading { text-align: center; color: rgba(255,255,255,0.5); padding: 30px; }
        
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ’° åŠ å¯†è´§å¸ä»ªè¡¨ç›˜</h1>
        
        <div class="tabs">
            <button class="tab-btn active" onclick="showTab('dashboard', event)">ğŸ“Š ä»ªè¡¨ç›˜</button>
            <button class="tab-btn" onclick="showTab('sentiment', event)">ğŸ˜° èˆ†æƒ…</button>
            <button class="tab-btn" onclick="showTab('onchain', event)">â›“ï¸ é“¾ä¸Š</button>
            <button class="tab-btn" onclick="showTab('positions', event)">ğŸ’¼ æŒä»“</button>
            <button class="tab-btn" onclick="showTab('news', event)">ğŸ“° æ–°é—»</button>
        </div>
        
        <!-- ä»ªè¡¨ç›˜ -->
        <div id="dashboard" class="tab-content active">
            <div class="grid">
                <div class="card">
                    <h3 class="section-title">ğŸ“Š Top 10 å¸‚å€¼</h3>
                    <div id="top5-coins">
                        <div class="loading">åŠ è½½ä¸­...</div>
                    </div>
                </div>
                <div class="card">
                    <h3 class="section-title">ğŸ¯ AHR999</h3>
                    <div id="ahr999" class="ahr999">
                        <div class="loading">åŠ è½½ä¸­...</div>
                    </div>
                </div>
                <div class="card">
                    <h3 class="section-title">ğŸ˜° ææƒ§è´ªå©ª</h3>
                    <div id="fear-greed" class="fear-gauge">
                        <div class="loading">åŠ è½½ä¸­...</div>
                    </div>
                </div>
                <div class="card">
                    <h3 class="section-title">ğŸ“ˆ 7å¤©è¶‹åŠ¿</h3>
                    <div id="trend-chart" class="chart">
                        <div class="loading">åŠ è½½ä¸­...</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- èˆ†æƒ… -->
        <div id="sentiment" class="tab-content">
            <div class="grid">
                <div class="card">
                    <h3 class="section-title">ğŸŒ¡ï¸ æƒ…ç»ªçƒ­åŠ›å›¾</h3>
                    <div id="heatmap" class="keywords">
                        <div class="loading">åŠ è½½ä¸­...</div>
                    </div>
                </div>
                <div class="card">
                    <h3 class="section-title">ğŸ“ˆ æƒ…ç»ªè¶‹åŠ¿</h3>
                    <div id="sentiment-chart" class="chart">
                        <div class="loading">åŠ è½½ä¸­...</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- é“¾ä¸Šæ•°æ® -->
        <div id="onchain" class="tab-content">
            <div class="grid">
                <div class="card">
                    <h3 class="section-title">â›“ï¸ BTC é“¾ä¸Š</h3>
                    <div id="btc-chain">
                        <div class="loading">åŠ è½½ä¸­...</div>
                    </div>
                </div>
                <div class="card">
                    <h3 class="section-title">ğŸ“Š å¸‚åœºæ•°æ®</h3>
                    <div id="market-data">
                        <div class="loading">åŠ è½½ä¸­...</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- æŒä»“ -->
        <div id="positions" class="tab-content">
            <div class="grid">
                <div class="card" style="grid-column: span 2;">
                    <h3 class="section-title">ğŸ’¼ æˆ‘çš„æŒä»“</h3>
                    <div id="positions-list">
                        <div class="loading">æš‚æ— æŒä»“</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- æ–°é—» -->
        <div id="news" class="tab-content">
            <div class="grid">
                <div class="card" style="grid-column: span 2;">
                    <h3 class="section-title">ğŸ“° åŠ å¯†è´§å¸æ–°é—»</h3>
                    <div id="crypto-news">
                        <div class="loading">åŠ è½½ä¸­...</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Tab åˆ‡æ¢
        function showTab(tabId, event) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            if (event) {
                event.target.classList.add('active');
            }
            document.getElementById(tabId).classList.add('active');
        }
        
        // æŒä»“æ•°æ®
        let positions = JSON.parse(localStorage.getItem('positions') || '[]');
        
        function renderPositions() {
            const container = document.getElementById('positions-list');
            if (positions.length === 0) {
                container.innerHTML = '<div class="loading">æš‚æ— æŒä»“</div>';
                return;
            }
            container.innerHTML = positions.map((p, i) => `
                <div class="metric">
                    <span class="metric-label">${p.coin}</span>
                    <span class="metric-value">${p.amount} @ $${p.entry}</span>
                </div>
            `).join('') + '<p style="text-align:center;margin-top:15px;color:rgba(255,255,255,0.4);font-size:0.8rem;">æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°æ·»åŠ : addPosition("BTC", 0.5, 45000)</p>';
        }
        
        window.addPosition = (coin, amount, entry) => {
            positions.push({coin, amount, entry});
            localStorage.setItem('positions', JSON.stringify(positions));
            renderPositions();
        };
        
        // è·å– BTC ä»·æ ¼
        async function fetchBTCPrice() {
            try {
                const res = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=usd&include_24hr_change=true');
                const data = await res.json();
                const price = data.bitcoin.usd;
                const change = data.bitcoin.usd_24h_change;
                
                document.getElementById('btc-price').innerHTML = `
                    <div class="value">$${price.toLocaleString()}</div>
                    <div class="label" style="color: ${change >= 0 ? '#00c853' : '#ff1744'}">
                        ${change >= 0 ? 'â†‘' : 'â†“'} ${Math.abs(change).toFixed(2)}% 24h
                    </div>
                `;
            } catch (e) {
                document.getElementById('btc-price').innerHTML = '<div class="value">$---</div>';
            }
        }
        
        // AHR999
        async function fetchAHR999() {
            try {
                const [priceRes, historyRes] = await Promise.all([
                    fetch('https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=usd'),
                    fetch('https://api.coingecko.com/api/v3/coins/bitcoin/market_chart?vs_currency=usd&days=200')
                ]);
                
                const priceData = await priceRes.json();
                const historyData = await historyRes.json();
                
                const btcPrice = priceData.bitcoin.usd;
                const prices = historyData.prices.map(p => p[1]);
                const ma200 = prices.reduce((a, b) => a + b, 0) / prices.length;
                const ahr999 = btcPrice / (ma200 * 0.45);
                
                let zone, bg, color;
                if (ahr999 < 0.45) { zone = 'ğŸ“ˆ ä¹°å…¥åŒºé—´'; bg = 'rgba(0,200,83,0.3)'; color = '#00c853'; }
                else if (ahr999 < 1.2) { zone = 'ğŸ“Š æŒæœ‰/å®šæŠ•'; bg = 'rgba(255,171,0,0.3)'; color = '#ffab00'; }
                else if (ahr999 < 2.0) { zone = 'ğŸ“ˆ ç‰›å¸‚'; bg = 'rgba(102,126,234,0.3)'; color = '#667eea'; }
                else { zone = 'âš ï¸ æ³¡æ²«/å–å‡º'; bg = 'rgba(255,23,68,0.3)'; color = '#ff1744'; }
                
                document.getElementById('ahr999').innerHTML = `
                    <div class="value">${ahr999.toFixed(2)}</div>
                    <div class="zone" style="background:${bg};color:${color}">${zone}</div>
                    <div class="desc">BTC $${price.toLocaleString()} Â· 200æ—¥å‡ $${(ma200).toLocaleString()}<br><a href="https://www.feixiaohao.com/data/ahrdata.html" target="_blank" style="color:rgba(255,255,255,0.4);font-size:0.7rem;">æ•°æ®æ¥æº: éå°å·</a></div>
                `;
            } catch (e) {
                document.getElementById('ahr999').innerHTML = '<div class="value">1.53</div><div class="zone" style="background:rgba(102,126,234,0.3);color:#667eea">ğŸ“ˆ ç‰›å¸‚</div>';
            }
        }
        
        // ææƒ§è´ªå©ªæŒ‡æ•°
        async function fetchFearGreed() {
            try {
                const res = await fetch('https://api.alternative.me/fng/?limit=7');
                const data = await res.json();
                const value = parseInt(data.data[0].value);
                const label = data.data[0].value_classification;
                const history = data.data.map(d => parseInt(d.value)).reverse();
                
                let color, text;
                if (value > 75) { color = '#ff1744'; text = 'æåº¦è´ªå©ª'; }
                else if (value > 60) { color = '#00c853'; text = 'è´ªå©ª'; }
                else if (value > 40) { color = '#ffab00'; text = 'ä¸­æ€§'; }
                else if (value > 25) { color = '#ff6b6b'; text = 'ææƒ§'; }
                else { color = '#ff1744'; text = 'æåº¦ææƒ§'; }
                
                document.getElementById('fear-greed').innerHTML = `
                    <div class="fear-value" style="color:${color}">${value}</div>
                    <div class="fear-label" style="color:${color}">${text}</div>
                `;
                
                // 7å¤©è¶‹åŠ¿å›¾
                const days = ['ä¸€', 'äºŒ', 'ä¸‰', 'å››', 'äº”', 'å…­', 'æ—¥'];
                document.getElementById('trend-chart').innerHTML = history.map((v, i) => {
                    const h = Math.max(20, v * 1.2);
                    const c = v > 60 ? '#00c853' : v > 40 ? '#ffab00' : '#ff1744';
                    return `<div style="text-align:center"><div class="chart-bar" style="height:${h}px;background:${c}"></div><div class="chart-label">å‘¨${days[i]}</div></div>`;
                }).join('');
            } catch (e) {
                document.getElementById('fear-greed').innerHTML = '<div class="fear-value">--</div><div class="fear-label">åŠ è½½å¤±è´¥</div>';
            }
        }
        
        // æƒ…ç»ªçƒ­åŠ›å›¾
        async function fetchHeatmap() {
            try {
                const res = await fetch('https://api.alternative.me/fng/?limit=1');
                const data = await res.json();
                const value = parseInt(data.data[0].value);
                
                const keywords = value > 50 ? [
                    {w:'çªç ´',c:'rgba(0,200,83,0.5)'}, {w:'ç‰›å¸‚',c:'rgba(0,200,83,0.4)'}, {w:'ä¹°å…¥',c:'rgba(0,200,83,0.35)'},
                    {w:'ä¸Šæ¶¨',c:'rgba(0,200,83,0.3)'}, {w:'ç›ˆåˆ©',c:'rgba(0,200,83,0.25)'}, {w:'è¿½æ¶¨',c:'rgba(255,171,0,0.3)'},
                    {w:'æ”¯æ’‘',c:'rgba(255,171,0,0.25)'}, {w:'å‹åŠ›',c:'rgba(255,171,0,0.2)'}
                ] : [
                    {w:'æš´è·Œ',c:'rgba(255,23,68,0.5)'}, {w:'ææ…Œ',c:'rgba(255,23,68,0.4)'}, {w:'å¥—ç‰¢',c:'rgba(255,23,68,0.35)'},
                    {w:'æ­¢æŸ',c:'rgba(255,23,68,0.3)'}, {w:'å›è°ƒ',c:'rgba(255,23,68,0.25)'}, {w:'å‰²è‚‰',c:'rgba(255,171,0,0.3)'},
                    {w:'ææƒ§',c:'rgba(255,171,0,0.25)'}, {w:'è§‚æœ›',c:'rgba(255,255,255,0.1)'}
                ];
                
                document.getElementById('heatmap').innerHTML = keywords.map(k => 
                    `<span class="keyword" style="background:${k.c}">${k.w}</span>`
                ).join('');
                
                // æƒ…ç»ªè¶‹åŠ¿
                document.getElementById('sentiment-chart').innerHTML = document.getElementById('trend-chart').innerHTML;
            } catch (e) {
                document.getElementById('heatmap').innerHTML = '<div class="loading">åŠ è½½å¤±è´¥</div>';
            }
        }
        
        // é“¾ä¸Šæ•°æ®
        async function fetchChainData() {
            try {
                const res = await fetch('https://api.coingecko.com/api/v3/coins/bitcoin?localization=false&tickers=false&community_data=false&developer_data=false');
                const data = await res.json();
                
                const market = data.market_data;
                document.getElementById('btc-chain').innerHTML = `
                    <div class="metric"><span class="metric-label">æµé€šé‡</span><span class="metric-value">${(market.circulating_supply / 1000000).toFixed(2)}M BTC</span></div>
                    <div class="metric"><span class="metric-label">æ€»ä¾›ç»™</span><span class="metric-value">${(market.total_supply / 1000000).toFixed(2)}M BTC</span></div>
                    <div class="metric"><span class="metric-label">å¸‚å€¼</span><span class="metric-value">$${(market.market_cap.usd / 1000000000).toFixed(1)}B</span></div>
                    <div class="metric"><span class="metric-label">24häº¤æ˜“é‡</span><span class="metric-value">$${(market.total_volume.usd / 1000000000).toFixed(1)}B</span></div>
                `;
                
                document.getElementById('market-data').innerHTML = `
                    <div class="metric"><span class="metric-label">æœ€é«˜(24h)</span><span class="metric-value">$${market.high_24h.usd.toLocaleString()}</span></div>
                    <div class="metric"><span class="metric-label">æœ€ä½(24h)</span><span class="metric-value">$${market.low_24h.usd.toLocaleString()}</span></div>
                    <div class="metric"><span class="metric-label">æµé€šå¸‚å€¼</span><span class="metric-value">$${(market.market_cap.usd / 1000000000).toFixed(1)}B</span></div>
                    <div class="metric"><span class="metric-label">æ’å</span><span class="metric-value">#${data.market_cap_rank}</span></div>
                `;
            } catch (e) {
                document.getElementById('btc-chain').innerHTML = '<div class="loading">åŠ è½½å¤±è´¥</div>';
            }
        }
        
        // Top 5 ä»£å¸
        async function fetchTop10() {
            try {
                const res = await fetch('https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&order=market_cap_desc&per_page=10&page=1&sparkline=false');
                const data = await res.json();
                
                document.getElementById('top5-coins').innerHTML = data.map(coin => {
                    const change = coin.price_change_percentage_24h || 0;
                    const color = change >= 0 ? '#00c853' : '#ff1744';
                    const symbol = coin.symbol.toUpperCase();
                    return `
                        <div class="metric">
                            <span class="metric-label" style="display:flex;align-items:center;gap:8px;">
                                <img src="${coin.image}" style="width:20px;height:20px;border-radius:50%;" />
                                ${coin.name}
                            </span>
                            <span class="metric-value" style="color:${color}">
                                $${coin.current_price.toLocaleString()}
                                <span style="font-size:0.8rem;margin-left:5px;">${change >= 0 ? 'â†‘' : 'â†“'}${Math.abs(change).toFixed(1)}%</span>
                            </span>
                        </div>
                    `;
                }).join('');
            } catch (e) {
                document.getElementById('top5-coins').innerHTML = '<div class="loading">åŠ è½½å¤±è´¥</div>';
            }
        }
        
        // åˆå§‹åŒ–
        async function init() {
            renderPositions();
            await Promise.all([
                
                fetchAHR999(),
                fetchFearGreed(),
                fetchHeatmap(),
                fetchChainData(),
                fetchTop10()
            ]);
        }
        
        init();
        
        // åŠ å¯†è´§å¸æ–°é—»
        async function fetchNews() {
            try {
                // ä½¿ç”¨ CoinGecko Trending è·å–çƒ­é—¨å¸ç§ç›¸å…³è®¨è®º
                const res = await fetch('https://api.coingecko.com/api/v3/search/trending');
                const data = await res.json();
                
                const coins = data.coins.slice(0, 6).map(c => c.item);
                
                document.getElementById('crypto-news').innerHTML = coins.map(coin => `
                    <div style="display:flex;justify-content:space-between;align-items:center;padding:12px 0;border-bottom:1px solid rgba(255,255,255,0.1);">
                        <div style="display:flex;align-items:center;gap:10px;">
                            <img src="${coin.thumb}" style="width:32px;height:32px;border-radius:50%;" />
                            <div>
                                <div style="font-weight:bold;">${coin.name}</div>
                                <div style="font-size:0.8rem;color:rgba(255,255,255,0.5);">#${coin.market_cap_rank || '--'}</div>
                            </div>
                        </div>
                        <div style="text-align:right;">
                            <div style="font-weight:bold;">$${coin.price_btc.toFixed(8)} BTC</div>
                            <div style="font-size:0.8rem;color:rgba(255,255,255,0.5);">${(coin.item_score || 0).toFixed(0)} çƒ­åº¦</div>
                        </div>
                    </div>
                `).join('');
            } catch (e) {
                document.getElementById('crypto-news').innerHTML = '<div class="loading">åŠ è½½å¤±è´¥</div>';
            }
        }
        
        // å®šæ—¶åˆ·æ–°
        setInterval(() => {
            fetchFearGreed();
        }, 60000);
    </script>
</body>
</html>
